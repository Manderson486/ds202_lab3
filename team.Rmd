---
title: "Team"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
data <- readxl::read_xls('GSS.xls')
library(dplyr)
library(ggplot2)
```

## Team Document
### Marcella Anderson, <boys put your names here>

Data Cleaning
```{r}
#the cleaning mario did
data$`Highest year of school completed` <- as.numeric(data$`Highest year of school completed`)
data$`Age of respondent` <- as.numeric(data$`Age of respondent`)
data$`R's age when 1st child born` <- as.numeric(data$`R's age when 1st child born`)
data$`Number of children` <- as.numeric(data$`Number of children`)
data <- data %>% na.omit
```

### Problem 1



### Problem 2



```{R}
library('dplyr')
library('ggplot2')
```

```{R}
data <- readxl::read_xls('C:/Users/justi/Desktop/DS202/ds202_lab3/ds202_lab3/GSS.xls')

data <- rename(data, 'Year'='Gss year for this respondent')
data <- rename(data, 'Rent' = 'Does r own or rent home?')
data <- rename(data, 'Happiness' = 'General happiness')
data <- rename(data, 'Party' = 'Political party affiliation')
data <- rename(data, 'Income'='Respondents income')
data <- rename(data, 'People'='Number of persons in household')
data <- rename(data, 'Sex' = 'Respondents sex')
data <- rename(data, 'Major' = 'College major 1')
data <- rename(data, 'Education'='Highest year of school completed')
data <- rename(data, 'Parent.age'="R's age when 1st child born")
data <- rename(data, 'Age'='Age of respondent')
data <- rename(data, 'Children'='Number of children')
data <- rename(data, 'Marital.status' = 'Marital status')
data <- rename(data, 'ID' = 'Respondent id number')
data <- rename(data, 'Ballot' = 'Ballot used for interview')
```

<h1>Question 3</h1>

```{r}
three <- data[, c(3, 4, 13)]
married <- filter(three, Marital.status == "Married")
notmarried <- filter(three, Marital.status != "Married")

happy_df <- filter(data, Happiness == "Very happy" | Happiness == "Pretty happy")
unhappy_df <- filter(data, Happiness != "Very happy" & Happiness != "Pretty happy")
```

```{R}
married1 = aggregate(married$Marital.status, by=list(married$Happiness), FUN=length)
marriedandhappy <- filter(three, Marital.status == "Married" & (Happiness == "Very happy" | Happiness == "Pretty happy"))
marriedandnothappy <- filter(three, Marital.status == "Married" & (Happiness != "Very happy" & Happiness != "Pretty happy"))



notmarried1 = aggregate(notmarried$Marital.status, by=list(notmarried$Happiness), FUN=length)
notmarriedandhappy <- filter(three, Marital.status != "Married" & (Happiness == "Very happy" | Happiness == "Pretty happy"))
notmarriedandnothappy <- filter(three, Marital.status != "Married" & (Happiness != "Very happy" & Happiness != "Pretty happy"))
```

The plots show that people who are married tend to be happier than people who are not married.


```{R}
p <- ggplot(married1, aes(x = Group.1, weight = x)) + geom_bar()
p + xlab("Happiness") + ylab("Number of People") + ggtitle("Plot of Happiness for Married People")
```
```{R}
p1 <- ggplot(notmarried1, aes(x = Group.1, weight = x)) + geom_bar()
p1 + xlab("Happiness") + ylab("Number of People") + ggtitle("Plot of Happiness for Non - Married People")
```
<h1>Question 4</h1>

```{R}

unique(happy_df$Party)

happy_indep_df <- happy_df %>%
  group_by(Marital.status) %>%
  filter(Party == "Independent" | Party == "Ind,near rep" | Party == "Ind,near dem")
happy_indep_df
df1 <- happy_indep_df %>%
  summarize(
    Total_Happy_Indep=n()
  )
df1

unhappy_indep_df <- unhappy_df %>%
  group_by(Marital.status) %>%
  filter(Party == "Independent" | Party == "Ind,near rep" | Party == "Ind,near dem")
happy_indep_df
df2 <- unhappy_indep_df %>%
  summarize(
    Total_Unhappy_Indep=n()
  )
df2

happy_rep_df <- happy_df %>%
  group_by(Marital.status) %>%
  filter(Party == "Strong republican" | Party == "Not str republican")
happy_indep_df
t1 <- happy_rep_df %>%
  summarize(
    Total_Happy_Rep=n()
  )
t1

unhappy_rep_df <- unhappy_df %>%
  group_by(Marital.status) %>%
  filter(Party == "Strong republican" | Party == "Not str republican")
unhappy_rep_df
t2 <- unhappy_rep_df %>%
  summarize(
    Total_Unhappy_Rep=n()
  )
t2

happy_dem_df <- happy_df %>%
  group_by(Marital.status) %>%
  filter(Party == "Strong democrat" | Party == "Not str democrat")
happy_dem_df
t3 <- happy_dem_df %>%
  summarize(
    Total_Happy_Dem=n()
  )
t3

unhappy_dem_df <- unhappy_df %>%
  group_by(Marital.status) %>%
  filter(Party == "Strong democrat" | Party == "Not str democrat")
unhappy_dem_df
t4 <- unhappy_dem_df %>%
  summarize(
    Total_Unhappy_Rep=n()
  )
t4

ggplot(happy_rep_df, aes(x=Party)) + geom_bar(color="blue", fill="red")
ggplot(unhappy_rep_df, aes(x=Party)) + geom_bar(color="blue", fill="red")
ggplot(happy_dem_df, aes(x=Party)) + geom_bar(color="red", fill="blue")
ggplot(unhappy_dem_df, aes(x=Party)) + geom_bar(color="red", fill="blue")
ggplot(happy_indep_df, aes(x=Party)) + geom_bar(color="black", fill="purple")
ggplot(unhappy_indep_df, aes(x=Party)) + geom_bar(color="black", fill="purple")



```

<h3>Conlusion</h3>
<p>
In general, there tend to be more happy people than unhappy people. Party does not seem to play a factor.




### Problem 5
```{r}

data$MarStatFact <- factor(data$`Marital status`, levels = c('Divorced','Married','Widowed','Never married','Separated', 'No answer'))

ggplot(data, aes(x=`Highest year of school completed`))+geom_bar() + facet_wrap(~ MarStatFact )

data %>% 
  group_by(MarStatFact) %>%
  summarize(mean_edu = mean(`Highest year of school completed`,na.rm=TRUE),
            sd_edu = sd(`Highest year of school completed`,na.rm=TRUE)) %>%
  arrange(mean_edu)
```

Though our graph shows similar curves of education for respondents of all marriage statuses, we can see in the averages that there is a slightly higher education level for divorced and married respondents than for the others. I found this very interesting. I would have thought that if there was any difference at all it would be noticed among widowed, separated, divorced, and married people compared to never married people. I do suspect that the reason widowed people have the lowest average education rate is usually widowed people are older. Education standards have increased over time, therefore it makes sense that there is a slight decrease in the number of educated participants of this category. 

### Problem 6

#### Comparing the number of people in a household to the age when the first child is born
```{r}

data$numPerInHouse <- factor(data$`Number of persons in household`, 1:12 )

ggplot(data, aes(x=`R's age when 1st child born`, fill = numPerInHouse))+geom_bar(color = 'black')+xlab("Age when First Child was Born")+ylab("count")+labs(fill = "Number of People in Household")+ggtitle("Age when First Child is Born by Number of People in Household")

ggplot(data, aes(x=`R's age when 1st child born`))+geom_bar() +facet_wrap(~ `Number of persons in household`, scales = 'free_y')+ggtitle("Age when First Child was Born Separated by Number of People in Household")

data %>%
  group_by(numPerInHouse) %>%
  summarize(mean_child = mean(`R's age when 1st child born`,na.rm=TRUE),
            sd_child = sd(`R's age when 1st child born`,na.rm=TRUE))
cor(x=data$`Number of persons in household`, y= data$`R's age when 1st child born`)
```
In comparing the year when the respondents first child was born and the number of persons in the household, we see there is very little correlation. In addition to this our graphs show that for people from each type of household the age when the first child is born follows a similar curve. In the colored chart we see very little shift in the graph based on the color of the bar, and in the grid of charts we see very little difference in the shape of the curves. In our data we see that the average age of the first born child is between 20 and 25 for all respondents. It is slightly lower for those in households with more than 6 people, but not by a large margin, and there is less data for these families as well which could impact the results. 





